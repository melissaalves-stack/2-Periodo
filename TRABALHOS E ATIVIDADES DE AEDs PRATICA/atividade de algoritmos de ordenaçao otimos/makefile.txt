# Makefile para compilaÃ§Ã£o do projeto de Algoritmos de OrdenaÃ§Ã£o Ã“timos

# Compilador e flags
CC = gcc
CFLAGS = -Wall -Wextra -O2 -std=c11
LDFLAGS = -lm

# Arquivos
TARGET = ordenacao
SOURCES = ordenacao.c
HEADERS = ordenacao.h
OBJECTS = $(SOURCES:.c=.o)

# Regra padrÃ£o
all: $(TARGET)
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo "âœ“ CompilaÃ§Ã£o concluÃ­da com sucesso!"
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo "Execute com: ./$(TARGET)"
	@echo ""

# Compilar o executÃ¡vel
$(TARGET): $(OBJECTS)
	@echo "ğŸ”— Linkando $(TARGET)..."
	$(CC) $(CFLAGS) -o $(TARGET) $(OBJECTS) $(LDFLAGS)

# Compilar arquivos objeto
%.o: %.c $(HEADERS)
	@echo "ğŸ”¨ Compilando $<..."
	$(CC) $(CFLAGS) -c $< -o $@

# Executar o programa
run: $(TARGET)
	@echo "â–¶ Executando $(TARGET)..."
	@echo ""
	./$(TARGET)

# Compilar com informaÃ§Ãµes de debug
debug: CFLAGS += -g -DDEBUG
debug: clean $(TARGET)
	@echo "âœ“ Compilado em modo DEBUG"

# Limpar arquivos compilados
clean:
	@echo "ğŸ§¹ Limpando arquivos compilados..."
	rm -f $(OBJECTS) $(TARGET)
	@echo "âœ“ Limpeza concluÃ­da!"

# Limpar e recompilar
rebuild: clean all

# Verificar vazamentos de memÃ³ria com valgrind
valgrind: $(TARGET)
	@echo "ğŸ” Executando valgrind para detecÃ§Ã£o de vazamentos..."
	valgrind --leak-check=full --show-leak-kinds=all --track-origins=yes ./$(TARGET)

# AnÃ¡lise de performance com time
benchmark: $(TARGET)
	@echo "â±ï¸  Executando benchmark de performance..."
	time ./$(TARGET)

# Verificar sintaxe sem compilar
check:
	@echo "âœ“ Verificando sintaxe..."
	$(CC) $(CFLAGS) -fsyntax-only $(SOURCES)
	@echo "âœ“ Sintaxe OK!"

# Mostrar informaÃ§Ãµes sobre o projeto
info:
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo "  PROJETO: Algoritmos de OrdenaÃ§Ã£o Ã“timos O(n log n)"
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo "Compilador: $(CC)"
	@echo "Flags: $(CFLAGS)"
	@echo "Target: $(TARGET)"
	@echo "Arquivos fonte: $(SOURCES)"
	@echo "Headers: $(HEADERS)"
	@echo ""
	@echo "Algoritmos implementados:"
	@echo "  â€¢ Merge Sort - DivisÃ£o e Conquista"
	@echo "  â€¢ Quick Sort - DivisÃ£o e Conquista"
	@echo "  â€¢ Heap Sort - Baseado em Heap"
	@echo ""
	@echo "Comandos disponÃ­veis:"
	@echo "  make         - Compila o projeto"
	@echo "  make run     - Compila e executa"
	@echo "  make debug   - Compila com sÃ­mbolos de debug"
	@echo "  make clean   - Remove arquivos compilados"
	@echo "  make rebuild - Limpa e recompila"
	@echo "  make valgrind - Verifica vazamentos de memÃ³ria"
	@echo "  make benchmark - Mede tempo de execuÃ§Ã£o"
	@echo "  make check   - Verifica sintaxe"
	@echo "  make info    - Mostra esta mensagem"
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Criar arquivo zip para entrega
zip: clean
	@echo "ğŸ“¦ Criando arquivo para entrega..."
	zip -r ordenacao_projeto.zip *.c *.h Makefile README.md 2>/dev/null || zip -r ordenacao_projeto.zip *.c *.h Makefile
	@echo "âœ“ Arquivo ordenacao_projeto.zip criado!"

# Evitar conflitos com arquivos de mesmo nome
.PHONY: all run debug clean rebuild valgrind benchmark check info zip